
{% extends "index.html" %}
{% block Alimentos %}
<div id="snack-container">
    <h1>Snacks y Bebidas</h1>
    <div style="display: flex; flex-wrap: wrap; gap: 20px;">
        {% for snack in alimentos %}
        <div class="snack-item" style="border: 1px solid #ccc; border-radius: 8px; width: 200px; text-align: center; padding: 10px;">
            <img src="{{ snack.img_url }}" alt="{{ snack.nombre }}" style="width: 100%; height: 150px; object-fit: cover;">
            <h3>{{ snack.nombre }}</h3>
            <p>{{ snack.descripcion }}</p>
            <p><strong>Precio:</strong> ${{ snack.precio }}</p>
            <button onclick="agregarAlCarrito({{ snack.id }})" style="background-color: #4CAF50; color: white; padding: 10px; border: none; cursor: pointer;">
                Agregar al Carrito
            </button>
        </div>
        {% endfor %}
    </div>
</div>

<div id="carrito-container" style="margin-top: 30px;">
    <h2>Carrito de Compras</h2>
    <table border="1" style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr>
                <th>Producto</th>
                <th>Precio</th>
                <th>Cantidad</th>
                <th>Total</th>
                <th>Acci贸n</th>
            </tr>
        </thead>
        <tbody id="carrito-body">
            {% for item in carrito %}
            <tr>
                <td>{{ item.nombre }}</td>
                <td>${{ item.precio }}</td>
                <td>
                    <input type="number" id="cantidad-{{ item.id }}" value="{{ item.cantidad }}" min="1" style="width: 50px; text-align: center;">
                </td>
                <td>${{ item.total }}</td>
                <td>
                    <button onclick="modificarCantidad({{ item.id }})" style="background-color: #2196F3; color: white; padding: 5px; border: none; cursor: pointer;">
                        Modificar
                    </button>
                    <button onclick="eliminarDelCarrito({{ item.id }})" style="background-color: #f44336; color: white; padding: 5px; border: none; cursor: pointer;">
                        Eliminar
                    </button>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    // Funci贸n para agregar un producto al carrito
    function agregarAlCarrito(idAlimento) {
        fetch('/agregar_carrito', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ id_alimento: idAlimento })
        }).then(response => {
            if (response.ok) {
                alert('Producto agregado al carrito');
                location.reload();
            } else {
                alert('Error al agregar producto al carrito');
            }
        });
    }

    // Funci贸n para eliminar un producto del carrito
    function eliminarDelCarrito(idCarrito) {
        fetch('/eliminar_carrito/' + idCarrito, {
            method: 'DELETE'
        }).then(response => {
            if (response.ok) {
                alert('Producto eliminado del carrito');
                location.reload();
            } else {
                alert('Error al eliminar producto del carrito');
            }
        });
    }

    // Funci贸n para modificar la cantidad de un producto en el carrito
    function modificarCantidad(idCarrito) {
        const cantidadInput = document.getElementById(`cantidad-${idCarrito}`);
        const nuevaCantidad = parseInt(cantidadInput.value);

        if (nuevaCantidad < 1) {
            alert('La cantidad debe ser mayor o igual a 1.');
            return;
        }

        fetch('/modificar_cantidad_carrito', {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ id_carrito: idCarrito, cantidad: nuevaCantidad })
        }).then(response => {
            if (response.ok) {
                alert('Cantidad modificada correctamente');
                location.reload();
            } else {
                alert('Error al modificar la cantidad');
            }
        });
    }
</script>
{% endblock %}
